<link href="css/default.css" style="text/css" rel="stylesheet">
<link href="css/library-icons.css" style="text/css" rel="stylesheet">
<link href="css/themes.css" style="text/css" rel="stylesheet">

<!-- 
    *
    * Third party javascript libraries:
    *	JQuery 1.4.4	http://jquery.org
    *	JIT	2.0 	created by Nicolas Garcia Belmonte of http://jit.org
    *	adobe air	provided by adobe air (aliasing to actionscript) 
    *
-->
<script src="js/air/air-aliases.js"></script>
<script src="js/jquery/jquery-1.4.4.js"></script>
<script src="js/jquery/core-widgets-mouse.js"></script>


<!-- 
  *
  * jxf framework and utilities
  *	rpc		performs rpc handling (ajax)
  *	dom		manipulation of dom objects (common tasks)
  *	sqlite		adobe air wrapper for handling sqlite dbase
  *	jxbinder	runtime loading of html documents this is a work around the annoying adobe air sandbox
  *
-->

<script src="js/jxf/jxbinder.js"></script>
<script src="js/jxf/google/jxf-google.js"></script>
<script src="js/jxf/dom.js"></script>
<script src="js/jxf/rpc.js"></script>
<script src="js/jxf/sqlite.js"></script>
<script src="js/jxf/widgets/jxwidgets.js"></script>
<script src="js/jxf/lastfm/parser.js"></script>
<!-- 
	*
	* This section are the scripts for storage providers
	* The order of the libraries seem to be important i.e
	
	*
-->
<script src="js/providers/google/gdocs-handler.js"></script>
<script src="js/providers/dropbox/dropbox.js"></script>
<script src="js/providers/playlist/playlist.js"></script>
<script src="js/library.js"></script>
<script src="js/providers/local/lstore.js"></script>

<!-- 
  *
  * system utilities and misceallaneous files that are specific to either 3-launchpad on air or to 3-launchpad processing
  * 
  *
-->
<script src="js/utils.js"></script>
<script src="js/player.js"></script>

<script src="/html/sys/setup/js/elp-system.js"></script>
<script src="/html/sys/setup/js/elp-media-player.js"></script>
<script src="/html/sys/setup/js/elp-plhandler.js"></script>
<script src="js/theme.js"></script>
<script src="js/updater.js"></script>
<script>
//   $(document).ready(function() {
//     $('#mediaplayer').roundabout();
//   });

    //-- 
  function Initialize(){
      theme.init() ;
      //library.init() ;   
      updater.init() ;
      utils.modules.setup() ;
      theme.set();
      lstore.load();
      dstore.load();
      utils.menu.show('player');     	 
      //jx.dom.show('default') ;
      menulib.open('all') ;
  }  

     
      
 
   var file = air.File.applicationStorageDirectory.resolvePath("3launchpad.db3") ;

    if(file.exists == false){
      air.trace(file.exists) 
      sqlite.run.create("3launchpad.db3") ;
      var create = "create table params(agn integer not null primary key, alias varchar not null unique, value varchar not null)" ;
      var insert = "insert into params (alias,value) values('theme','clone')" ;
      sqlite.run.cmd(file.nativePath,create) ;
      sqlite.run.cmd(file.nativePath,insert) ;
      sqlite.run.cmd(file.nativePath,"insert into params(alias,value) values('local.library','{}')") ;
      sqlite.run.cmd(file.nativePath,"insert into params(alias,value) values('dropbox.library','{}')");
	
    }
    //
// The code below needs to run before the pages are loaded. 
// This allows the various dependencies to be ready for use and to circumvent the adobe air security restrictions
// 
//    Providers.init() ;
  
	utils.modules.init('menu','menu.html','mui') 
	utils.modules.init('google','providers/google/index.html','config') ;
	utils.modules.init('dropbox','providers/dropbox/index.html','config') ;
	utils.modules.init('local','providers/local/index.html','config') ;
	utils.modules.init('theme','theme.html','config') ; 
	utils.modules.init('mlibrary','library.html','config') ;
	utils.modules.init('help','help.html','stdout')     ;
	utils.modules.init('player','player.html','default');
  
      lstore.init.lookup() ;
      dstore.init.lookup();
//
// The code below is invoked by the library tabs and handles various interactions where the library
// i.e the list of songs will appear.
// TODO: The section below needs to be put into the appropriate file 
//
var menulib={
  open:function(id){
    var tabs =['all','google','local','dropbox'] ;
    for(var i=0; i < tabs.length; i++){
      jx.dom.set.css(tabs[i]+'-tab','inactive-tab') ;
    }
    jx.dom.set.css(id+'-tab','active-tab') ;
    library.render('mainlib',id)
  },//-- menulib.open(id)
  player:{
    
    next:function(){
      var option = {} ;
      option.width  = '0'
      option.display='none'
      var pointer=function(){
	jx.dom.show('menupanel1');
	jx.dom.hide('menupanel2') ;
	jx.dom.set.style('menupanel2','width','100%') ;
      }
      $('#menupanel2').animate(option,2000,pointer);
    }
  }//-- end menulib.player.next()
}


</script>
<style>
   .roundabout-holder { padding: 1px;width:80%; height: 90%; }
   
   .roundabout-moveable-item { 
      height: 80%; 
      width: 72%; 
      cursor: pointer;
      
      -webkit-border-radius:10px;
      padding:10px;
      border: 1px solid #999;
      background:#f3f3f3;
      opacity:0.5;
      
   }
   
   .roundabout-in-focus { cursor: auto; }
   .inactive-tab{
    -webkit-border-top-right-radius:5px;
    -webkit-border-top-left-radius:5px;
    width:55px;
    border:1px solid gray;
    border-bottom:0px ;
    background-color:#f3f3f3;
   }
   .active-tab{
    -webkit-border-top-right-radius:5px;
    -webkit-border-top-left-radius:5px;
    width:55px;
    border:1px solid gray;
    border-bottom:0px ;
    background-color:#d3d3d3;
    font-weight:bold;
   }
</style>

<body id="body" class="default" onload="Initialize()" style="">
<div  style="width:95%; border:5px double gray; padding:2px; margin-top:5px">
  <div style="background-color:#d3d3d3;border-bottom:1px solid gray; cursor:move;" onmousedown="nativeWindow.startMove()">
    <span onclick="player.controls.stop(); window.location.reload()" style="cursor:pointer">
    <b>3-Launchpad</b></span><span> - Desktop Edition </span>
   
  </div>
  <span id="version" class="small" style="position:absolute; margin-top:3px"></span>
  <span></span>
<div id="app" style="height:90%; padding:3px">
<div >
  <img src="img/default/close.png" style="margin-left:88%;margin-top:-1%; position:absolute; z-index:2" class="action" onclick="jx.dom.show('default'); jx.dom.hide('stdout'); jx.dom.hide('mui');"/>
  <div id="stdout" style="display:none; opacity:0.9; background-color:#f3f3f3; margin-top:3%; margin-left:4%; width:92%; height:80%; border:2px solid gray" class="rounded-corners" onmouseover="$('#mainmenu').slideUp()"></div>
  <div id="mui" style="display:none; opacity:0.9; background-color:#f3f3f3; margin-top:3%; margin-left:4%; width:92%; height:80%; border:2px solid gray" class="rounded-corners" onmouseover="$('#mainmenu').slideUp()"></div>
  
  <div id="default" style="opacity:0.9; background-color:#f3f3f3; margin-top:3%; margin-left:4%; width:92%; height:80%; border:2px solid gray; padding:5px" class="rounded-corners" onmouseover="$('#mainmenu').slideUp(); $('#controls').fadeIn()">
  </div>
</div>

<div id="mainmenu" class="shaded" style="margin-left:15%; position:absolute;z-index:3; bottom:42; border:2px solid gray; " >

<table  align="center">
  <tr class="medium" >
  <td align="center" class="action" width="48px" onclick="utils.modules.show('default','player');  ">
    <img src="img/gnomefoot.png">
    
  </td>
  <td align="center" class="action" width="48px" style="border-left:1px solid gray" onclick="utils.modules.show('mui','menu'); jx.dom.show('config');utils.menu.show('theme'); ">
    <img src="img/default/theme.png">
    
  </td>
  <td align="center" class="action" width="48px" style="border-left:1px solid gray" onclick="utils.modules.show('mui','menu'); jx.dom.show('config');utils.menu.show('local'); ">
    <img src="img/drive.png">
    
  </td>
  <td align="center" class="action" width="48px" style="border-left:1px solid gray" onclick="utils.modules.show('mui','menu'); jx.dom.show('config');utils.menu.show('google'); jx.dom.set.focus('email')">
    <img src="img/google-logo.png">
    
  </td>
    <td align="center" class="action" width="48px" style="border-left:1px solid gray" onclick="utils.modules.show('mui','menu'); jx.dom.show('config');utils.menu.show('dropbox')">
    <img src="img/dropbox-logo.png">
    
  </td>
  <td align="center" class="action" width="48px" style="border-left:1px solid gray" onclick="utils.modules.show('mui','menu'); jx.dom.show('config');">
    <img src="img/setup.png">
    
  </td>
  <td align="center" class="action" width="48px" style="border-left:1px solid gray" onclick="utils.modules.show('stdout','help');">
    <img src="img/default/info.png">
    
  </td>
  <td class="action" align="center" width="48px" style="border-left:1px solid gray" onclick="window.close()">
    <img src="img/logoff.png">
    
  </td>  

</tr>

</table>
</div>
<div style="border:0px solid black; position:absolute; height:40px;width:94%" onmouseover="$('#mainmenu').slideDown(); $('#controls').fadeOut(); ">
  <!--
    * 
    * This area enables the menu showing and hiding upon mouse position
    *
  -->
</div>

</body>
